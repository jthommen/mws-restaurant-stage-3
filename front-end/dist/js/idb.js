"use strict";!function(){function e(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function t(t,n,o){var r,i=new Promise(function(i,u){e(r=t[n].apply(t,o)).then(i,u)});return i.request=r,i}function n(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function o(e,n,o,r){r.forEach(function(r){r in o.prototype&&(e.prototype[r]=function(){return t(this[n],r,arguments)})})}function r(e,t,n,o){o.forEach(function(o){o in n.prototype&&(e.prototype[o]=function(){return this[t][o].apply(this[t],arguments)})})}function i(e,n,o,r){r.forEach(function(r){r in o.prototype&&(e.prototype[r]=function(){return e=this[n],(o=t(e,r,arguments)).then(function(e){if(e)return new c(e,o.request)});var e,o})})}function u(e){this._index=e}function c(e,t){this._cursor=e,this._request=t}function s(e){this._store=e}function a(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function p(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new a(n)}function f(e){this._db=e}n(u,"_index",["name","keyPath","multiEntry","unique"]),o(u,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),i(u,"_index",IDBIndex,["openCursor","openKeyCursor"]),n(c,"_cursor",["direction","key","primaryKey","value"]),o(c,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(c.prototype[t]=function(){var n=this,o=arguments;return Promise.resolve().then(function(){return n._cursor[t].apply(n._cursor,o),e(n._request).then(function(e){if(e)return new c(e,n._request)})})})}),s.prototype.createIndex=function(){return new u(this._store.createIndex.apply(this._store,arguments))},s.prototype.index=function(){return new u(this._store.index.apply(this._store,arguments))},n(s,"_store",["name","keyPath","indexNames","autoIncrement"]),o(s,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),i(s,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),r(s,"_store",IDBObjectStore,["deleteIndex"]),a.prototype.objectStore=function(){return new s(this._tx.objectStore.apply(this._tx,arguments))},n(a,"_tx",["objectStoreNames","mode"]),r(a,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new s(this._db.createObjectStore.apply(this._db,arguments))},n(p,"_db",["name","version","objectStoreNames"]),r(p,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new a(this._db.transaction.apply(this._db,arguments))},n(f,"_db",["name","version","objectStoreNames"]),r(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[s,u].forEach(function(t){t.prototype[e.replace("open","iterate")]=function(){var t,n=(t=arguments,Array.prototype.slice.call(t)),o=n[n.length-1],r=this._store||this._index,i=r[e].apply(r,n.slice(0,-1));i.onsuccess=function(){o(i.result)}}})}),[u,s].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,o=[];return new Promise(function(r){n.iterateCursor(e,function(e){e?(o.push(e.value),void 0===t||o.length!=t?e.continue():r(o)):r(o)})})})});var d={open:function(e,n,o){var r=t(indexedDB,"open",[e,n]),i=r.request;return i.onupgradeneeded=function(e){o&&o(new p(i.result,e.oldVersion,i.transaction))},r.then(function(e){return new f(e)})},delete:function(e){return t(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=d,module.exports.default=module.exports):self.idb=d}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlkYi5qcyJdLCJuYW1lcyI6WyJwcm9taXNpZnlSZXF1ZXN0IiwicmVxdWVzdCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwib25zdWNjZXNzIiwicmVzdWx0Iiwib25lcnJvciIsImVycm9yIiwicHJvbWlzaWZ5UmVxdWVzdENhbGwiLCJvYmoiLCJtZXRob2QiLCJhcmdzIiwicCIsImFwcGx5IiwidGhlbiIsInByb3h5UHJvcGVydGllcyIsIlByb3h5Q2xhc3MiLCJ0YXJnZXRQcm9wIiwicHJvcGVydGllcyIsImZvckVhY2giLCJwcm9wIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJwcm90b3R5cGUiLCJnZXQiLCJ0aGlzIiwic2V0IiwidmFsIiwicHJveHlSZXF1ZXN0TWV0aG9kcyIsIkNvbnN0cnVjdG9yIiwiYXJndW1lbnRzIiwicHJveHlNZXRob2RzIiwicHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyIsInZhbHVlIiwiQ3Vyc29yIiwiSW5kZXgiLCJpbmRleCIsIl9pbmRleCIsIl9jdXJzb3IiLCJjdXJzb3IiLCJjb21wbGV0ZSIsImlkYlRyYW5zYWN0aW9uIiwiVHJhbnNhY3Rpb24iLCJfdHgiLCJEQiIsIm9uYWJvcnQiLCJPYmplY3RTdG9yZSIsIml0ZW1zIiwiZGIiLCJvbGRWZXJzaW9uIiwidHJhbnNhY3Rpb24iLCJfZGIiLCJpbnN0YW5jZSIsIml0ZXJhdGVDdXJzb3IiLCJvcGVuIiwiSURCSW5kZXgiLCJJREJDdXJzb3IiLCJtZXRob2ROYW1lIiwiX3JlcXVlc3QiLCJJREJPYmplY3RTdG9yZSIsImNyZWF0ZUluZGV4IiwiX3N0b3JlIiwiSURCVHJhbnNhY3Rpb24iLCJVcGdyYWRlREIiLCJuYXRpdmVPYmplY3QiLCJmdW5jTmFtZSIsIm9iamVjdFN0b3JlIiwiY3JlYXRlT2JqZWN0U3RvcmUiLCJjb3VudCIsIklEQkRhdGFiYXNlIiwib251cGdyYWRlbmVlZGVkIiwidXBncmFkZUNhbGxiYWNrIiwiZGVsZXRlIiwibW9kdWxlIiwiZGVmYXVsdCIsImV4cG9ydHMiLCJyZXBsYWNlIiwic2VsZiIsImFyciIsImlkYiIsIkFycmF5Iiwic2xpY2UiLCJjYWxsIiwiY2FsbGJhY2siLCJsZW5ndGgiLCJnZXRBbGwiLCJxdWVyeSIsInB1c2giLCJ1bmRlZmluZWQiLCJjb250aW51ZSIsImV4cCIsIm5hbWUiLCJ2ZXJzaW9uIiwiaW5kZXhlZERCIiwiZXZlbnQiXSwibWFwcGluZ3MiOiJBQUFBLGNBRUMsV0FLQSxTQUFTQSxFQUFpQkMsR0FDekIsT0FBTyxJQUFJQyxRQUFRLFNBQUFDLEVBQUFDLEdBQ2xCSCxFQUFRSSxVQUFZLFdBQ25CRixFQUFRRixFQUFRSyxTQUdqQkwsRUFBUU0sUUFBVSxXQUNqQkgsRUFBT0gsRUFBUU8sVUFLbEIsU0FBU0MsRUFBcUJDLEVBQUtDLEVBQVFDLEdBQzFDLElBQUlYLEVBQ0FZLEVBQUksSUFBSVgsUUFBUSxTQUFBQyxFQUFBQyxHQUVuQkosRUFEQUMsRUFBVVMsRUFBSUMsR0FBUUcsTUFBTUosRUFBS0UsSUFDUEcsS0FBS1osRUFBU0MsS0FJekMsT0FEQVMsRUFBRVosUUFBVUEsRUFDTFksRUFXUixTQUFTRyxFQUFnQkMsRUFBWUMsRUFBWUMsR0FDaERBLEVBQVdDLFFBQVEsU0FBQUMsR0FDbEJDLE9BQU9DLGVBQWVOLEVBQVdPLFVBQVdILEdBQzNDSSxJQUFLLFdBQ0osT0FBT0MsS0FBS1IsR0FBWUcsSUFFekJNLElBQUssU0FBQUMsR0FDSkYsS0FBS1IsR0FBWUcsR0FBUU8sT0FNN0IsU0FBU0MsRUFBb0JaLEVBQVlDLEVBQVlZLEVBQWFYLEdBQ2pFQSxFQUFXQyxRQUFRLFNBQUFDLEdBQ1pBLEtBQVFTLEVBQVlOLFlBQzFCUCxFQUFXTyxVQUFVSCxHQUFRLFdBQzVCLE9BQU9aLEVBQXFCaUIsS0FBS1IsR0FBYUcsRUFBTVUsZUFLdkQsU0FBU0MsRUFBYWYsRUFBWUMsRUFBWVksRUFBYVgsR0FDMURBLEVBQVdDLFFBQVEsU0FBQUMsR0FDWkEsS0FBUVMsRUFBWU4sWUFDMUJQLEVBQVdPLFVBQVVI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LEVBQU9OLFlBRUp1RCxJQUFWcEIsR0FBdUJyQixFQUFNcUMsUUFBVWhCLEVBSTNDN0IsRUFBT2tELFdBSE52RixFQUFRNkMsSUFOUjdDLEVBQVE2QyxXQWViLElBQUkyQyxHQUNIcEMsS0FBTSxTQUFTcUMsRUFBTUMsRUFBU3JCLEdBQzdCLElBQUkzRCxFQUFJSixFQUFxQnFGLFVBQVcsUUFBU0YsRUFBTUMsSUFDbkQ1RixFQUFVWSxFQUFFWixRQVFoQixPQU5BQSxFQUFRc0UsZ0JBQWtCLFNBQVN3QixHQUM5QnZCLEdBQ0hBLEVBQWdCLElBQUlSLEVBQVUvRCxFQUFRSyxPQUFReUYsRUFBTTdDLFdBQVlqRCxFQUFRa0QsZUFJbkV0QyxFQUFFRSxLQUFLLFNBQVNrQyxHQUN0QixPQUFPLElBQUlKLEVBQUdJLE1BR2hCd0IsT0FBUSxTQUFTbUIsR0FDaEIsT0FBT25GLEVBQXFCcUYsVUFBVyxrQkFBbUJGLE1BSXRDLG9CQUFYbEIsUUFDVkEsT0FBT0UsUUFBVWUsRUFDakJqQixPQUFPRSxRQUFRRCxRQUFVRCxPQUFPRSxTQUdoQ0UsS0FBS0UsSUFBTVcsRUFsVFoiLCJmaWxlIjoiaWRiLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24oKSB7XG5cdGZ1bmN0aW9uIHRvQXJyYXkoYXJyKSB7XG5cdFx0cmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFycik7XG5cdH1cblxuXHRmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpIHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRyZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXNvbHZlKHJlcXVlc3QucmVzdWx0KTtcblx0XHRcdH07XG5cblx0XHRcdHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZWplY3QocmVxdWVzdC5lcnJvcik7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpIHtcblx0XHR2YXIgcmVxdWVzdDtcblx0XHR2YXIgcCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0cmVxdWVzdCA9IG9ialttZXRob2RdLmFwcGx5KG9iaiwgYXJncyk7XG5cdFx0XHRwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcblx0XHR9KTtcblxuXHRcdHAucmVxdWVzdCA9IHJlcXVlc3Q7XG5cdFx0cmV0dXJuIHA7XG5cdH1cblxuXHRmdW5jdGlvbiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xuXHRcdHZhciBwID0gcHJvbWlzaWZ5UmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpO1xuXHRcdHJldHVybiBwLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdGlmICghdmFsdWUpIHJldHVybjtcblx0XHRcdHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBwLnJlcXVlc3QpO1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJveHlQcm9wZXJ0aWVzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIHByb3BlcnRpZXMpIHtcblx0XHRwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KFByb3h5Q2xhc3MucHJvdG90eXBlLCBwcm9wLCB7XG5cdFx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF07XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHNldDogZnVuY3Rpb24odmFsKSB7XG5cdFx0XHRcdFx0dGhpc1t0YXJnZXRQcm9wXVtwcm9wXSA9IHZhbDtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiBwcm94eVJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG5cdFx0cHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcblx0XHRcdGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuXHRcdFx0UHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKHRoaXNbdGFyZ2V0UHJvcF0sIHByb3AsIGFyZ3VtZW50cyk7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJveHlNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG5cdFx0cHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcblx0XHRcdGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuXHRcdFx0UHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF0uYXBwbHkodGhpc1t0YXJnZXRQcm9wXSwgYXJndW1lbnRzKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG5cdFx0cHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcblx0XHRcdGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuXHRcdFx0UHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKHRoaXNbdGFyZ2V0UHJvcF0sIHByb3AsIGFyZ3VtZW50cyk7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gSW5kZXgoaW5kZXgpIHtcblx0XHR0aGlzLl9pbmRleCA9IGluZGV4O1xuXHR9XG5cblx0cHJveHlQcm9wZXJ0aWVzKEluZGV4LCAnX2luZGV4JywgW1xuXHRcdCduYW1lJyxcblx0XHQna2V5UGF0aCcsXG5cdFx0J211bHRpRW50cnknLFxuXHRcdCd1bmlxdWUnXG5cdF0pO1xuXG5cdHByb3h5UmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuXHRcdCdnZXQnLFxuXHRcdCdnZXRLZXknLFxuXHRcdCdnZXRBbGwnLFxuXHRcdCdnZXRBbGxLZXlzJyxcblx0XHQnY291bnQnXG5cdF0pO1xuXG5cdHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuXHRcdCdvcGVuQ3Vyc29yJyxcblx0XHQnb3BlbktleUN1cnNvcidcblx0XSk7XG5cblx0ZnVuY3Rpb24gQ3Vyc29yKGN1cnNvciwgcmVxdWVzdCkge1xuXHRcdHRoaXMuX2N1cnNvciA9IGN1cnNvcjtcblx0XHR0aGlzLl9yZXF1ZXN0ID0gcmVxdWVzdDtcblx0fVxuXG5cdHByb3h5UHJvcGVydGllcyhDdXJzb3IsICdfY3Vyc29yJywgW1xuXHRcdCdkaXJlY3Rpb24nLFxuXHRcdCdrZXknLFxuXHRcdCdwcmltYXJ5S2V5Jyxcblx0XHQndmFsdWUnXG5cdF0pO1xuXG5cdHByb3h5UmVxdWVzdE1ldGhvZHMoQ3Vyc29yLCAnX2N1cnNvcicsIElEQkN1cnNvciwgW1xuXHRcdCd1cGRhdGUnLFxuXHRcdCdkZWxldGUnXG5cdF0pO1xuXG5cdC8vIHByb3h5ICduZXh0JyBtZXRob2RzXG5cdFsnYWR2YW5jZScsICdjb250aW51ZScsICdjb250aW51ZVByaW1hcnlLZXknXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZE5hbWUpIHtcblx0XHRpZiAoIShtZXRob2ROYW1lIGluIElEQkN1cnNvci5wcm90b3R5cGUpKSByZXR1cm47XG5cdFx0Q3Vyc29yLnByb3RvdHlwZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGN1cnNvciA9IHRoaXM7XG5cdFx0XHR2YXIgYXJncyA9IGFyZ3VtZW50cztcblx0XHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRjdXJzb3IuX2N1cnNvclttZXRob2ROYW1lXS5hcHBseShjdXJzb3IuX2N1cnNvciwgYXJncyk7XG5cdFx0XHRcdHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KGN1cnNvci5fcmVxdWVzdCkudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRcdGlmICghdmFsdWUpIHJldHVybjtcblx0XHRcdFx0XHRyZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgY3Vyc29yLl9yZXF1ZXN0KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9KTtcblxuXHRmdW5jdGlvbiBPYmplY3RTdG9yZShzdG9yZSkge1xuXHRcdHRoaXMuX3N0b3JlID0gc3RvcmU7XG5cdH1cblxuXHRPYmplY3RTdG9yZS5wcm90b3R5cGUuY3JlYXRlSW5kZXggPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmNyZWF0ZUluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcblx0fTtcblxuXHRPYmplY3RTdG9yZS5wcm90b3R5cGUuaW5kZXggPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcblx0fTtcblxuXHRwcm94eVByb3BlcnRpZXMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBbXG5cdFx0J25hbWUnLFxuXHRcdCdrZXlQYXRoJyxcblx0XHQnaW5kZXhOYW1lcycsXG5cdFx0J2F1dG9JbmNyZW1lbnQnXG5cdF0pO1xuXG5cdHByb3h5UmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuXHRcdCdwdXQnLFxuXHRcdCdhZGQnLFxuXHRcdCdkZWxldGUnLFxuXHRcdCdjbGVhcicsXG5cdFx0J2dldCcsXG5cdFx0J2dldEFsbCcsXG5cdFx0J2dldEtleScsXG5cdFx0J2dldEFsbEtleXMnLFxuXHRcdCdjb3VudCdcblx0XSk7XG5cblx0cHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG5cdFx0J29wZW5DdXJzb3InLFxuXHRcdCdvcGVuS2V5Q3Vyc29yJ1xuXHRdKTtcblxuXHRwcm94eU1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuXHRcdCdkZWxldGVJbmRleCdcblx0XSk7XG5cblx0ZnVuY3Rpb24gVHJhbnNhY3Rpb24oaWRiVHJhbnNhY3Rpb24pIHtcblx0XHR0aGlzLl90eCA9IGlkYlRyYW5zYWN0aW9uO1xuXHRcdHRoaXMuY29tcGxldGUgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdGlkYlRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0fTtcblx0XHRcdGlkYlRyYW5zYWN0aW9uLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcblx0XHRcdH07XG5cdFx0XHRpZGJUcmFuc2FjdGlvbi5vbmFib3J0ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9XG5cblx0VHJhbnNhY3Rpb24ucHJvdG90eXBlLm9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl90eC5vYmplY3RTdG9yZS5hcHBseSh0aGlzLl90eCwgYXJndW1lbnRzKSk7XG5cdH07XG5cblx0cHJveHlQcm9wZXJ0aWVzKFRyYW5zYWN0aW9uLCAnX3R4JywgW1xuXHRcdCdvYmplY3RTdG9yZU5hbWVzJyxcblx0XHQnbW9kZSdcblx0XSk7XG5cblx0cHJveHlNZXRob2RzKFRyYW5zYWN0aW9uLCAnX3R4JywgSURCVHJhbnNhY3Rpb24sIFtcblx0XHQnYWJvcnQnXG5cdF0pO1xuXG5cdGZ1bmN0aW9uIFVwZ3JhZGVEQihkYiwgb2xkVmVyc2lvbiwgdHJhbnNhY3Rpb24pIHtcblx0XHR0aGlzLl9kYiA9IGRiO1xuXHRcdHRoaXMub2xkVmVyc2lvbiA9IG9sZFZlcnNpb247XG5cdFx0dGhpcy50cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7XG5cdH1cblxuXHRVcGdyYWRlREIucHJvdG90eXBlLmNyZWF0ZU9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl9kYi5jcmVhdGVPYmplY3RTdG9yZS5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XG5cdH07XG5cblx0cHJveHlQcm9wZXJ0aWVzKFVwZ3JhZGVEQiwgJ19kYicsIFtcblx0XHQnbmFtZScsXG5cdFx0J3ZlcnNpb24nLFxuXHRcdCdvYmplY3RTdG9yZU5hbWVzJ1xuXHRdKTtcblxuXHRwcm94eU1ldGhvZHMoVXBncmFkZURCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcblx0XHQnZGVsZXRlT2JqZWN0U3RvcmUnLFxuXHRcdCdjbG9zZSdcblx0XSk7XG5cblx0ZnVuY3Rpb24gREIoZGIpIHtcblx0XHR0aGlzLl9kYiA9IGRiO1xuXHR9XG5cblx0REIucHJvdG90eXBlLnRyYW5zYWN0aW9uID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIG5ldyBUcmFuc2FjdGlvbih0aGlzLl9kYi50cmFuc2FjdGlvbi5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XG5cdH07XG5cblx0cHJveHlQcm9wZXJ0aWVzKERCLCAnX2RiJywgW1xuXHRcdCduYW1lJyxcblx0XHQndmVyc2lvbicsXG5cdFx0J29iamVjdFN0b3JlTmFtZXMnXG5cdF0pO1xuXG5cdHByb3h5TWV0aG9kcyhEQiwgJ19kYicsIElEQkRhdGFiYXNlLCBbXG5cdFx0J2Nsb3NlJ1xuXHRdKTtcblxuXHQvLyBBZGQgY3Vyc29yIGl0ZXJhdG9yc1xuXHQvLyBUT0RPOiByZW1vdmUgdGhpcyBvbmNlIGJyb3dzZXJzIGRvIHRoZSByaWdodCB0aGluZyB3aXRoIHByb21pc2VzXG5cdFsnb3BlbkN1cnNvcicsICdvcGVuS2V5Q3Vyc29yJ10uZm9yRWFjaChmdW5jdGlvbihmdW5jTmFtZSkge1xuXHRcdFtPYmplY3RTdG9yZSwgSW5kZXhdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcblx0XHRcdENvbnN0cnVjdG9yLnByb3RvdHlwZVtmdW5jTmFtZS5yZXBsYWNlKCdvcGVuJywgJ2l0ZXJhdGUnKV0gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cyk7XG5cdFx0XHRcdHZhciBjYWxsYmFjayA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcblx0XHRcdFx0dmFyIG5hdGl2ZU9iamVjdCA9IHRoaXMuX3N0b3JlIHx8IHRoaXMuX2luZGV4O1xuXHRcdFx0XHR2YXIgcmVxdWVzdCA9IG5hdGl2ZU9iamVjdFtmdW5jTmFtZV0uYXBwbHkobmF0aXZlT2JqZWN0LCBhcmdzLnNsaWNlKDAsIC0xKSk7XG5cdFx0XHRcdHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2socmVxdWVzdC5yZXN1bHQpO1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fSk7XG5cblx0Ly8gcG9seWZpbGwgZ2V0QWxsXG5cdFtJbmRleCwgT2JqZWN0U3RvcmVdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcblx0XHRpZiAoQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCkgcmV0dXJuO1xuXHRcdENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwgPSBmdW5jdGlvbihxdWVyeSwgY291bnQpIHtcblx0XHRcdHZhciBpbnN0YW5jZSA9IHRoaXM7XG5cdFx0XHR2YXIgaXRlbXMgPSBbXTtcblxuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcblx0XHRcdFx0aW5zdGFuY2UuaXRlcmF0ZUN1cnNvcihxdWVyeSwgZnVuY3Rpb24oY3Vyc29yKSB7XG5cdFx0XHRcdFx0aWYgKCFjdXJzb3IpIHtcblx0XHRcdFx0XHRcdHJlc29sdmUoaXRlbXMpO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpdGVtcy5wdXNoKGN1cnNvci52YWx1ZSk7XG5cblx0XHRcdFx0XHRpZiAoY291bnQgIT09IHVuZGVmaW5lZCAmJiBpdGVtcy5sZW5ndGggPT0gY291bnQpIHtcblx0XHRcdFx0XHRcdHJlc29sdmUoaXRlbXMpO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRjdXJzb3IuY29udGludWUoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9KTtcblxuXHR2YXIgZXhwID0ge1xuXHRcdG9wZW46IGZ1bmN0aW9uKG5hbWUsIHZlcnNpb24sIHVwZ3JhZGVDYWxsYmFjaykge1xuXHRcdFx0dmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdvcGVuJywgW25hbWUsIHZlcnNpb25dKTtcblx0XHRcdHZhciByZXF1ZXN0ID0gcC5yZXF1ZXN0O1xuXG5cdFx0XHRyZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdGlmICh1cGdyYWRlQ2FsbGJhY2spIHtcblx0XHRcdFx0XHR1cGdyYWRlQ2FsbGJhY2sobmV3IFVwZ3JhZGVEQihyZXF1ZXN0LnJlc3VsdCwgZXZlbnQub2xkVmVyc2lvbiwgcmVxdWVzdC50cmFuc2FjdGlvbikpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHRyZXR1cm4gcC50aGVuKGZ1bmN0aW9uKGRiKSB7XG5cdFx0XHRcdHJldHVybiBuZXcgREIoZGIpO1xuXHRcdFx0fSk7XG5cdFx0fSxcblx0XHRkZWxldGU6IGZ1bmN0aW9uKG5hbWUpIHtcblx0XHRcdHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdkZWxldGVEYXRhYmFzZScsIFtuYW1lXSk7XG5cdFx0fVxuXHR9O1xuXG5cdGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuXHRcdG1vZHVsZS5leHBvcnRzID0gZXhwO1xuXHRcdG1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBtb2R1bGUuZXhwb3J0cztcblx0fVxuXHRlbHNlIHtcblx0XHRzZWxmLmlkYiA9IGV4cDtcblx0fVxufSgpKTsiXX0=
